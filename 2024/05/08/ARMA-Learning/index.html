
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.26.8" theme-name="Stellar" theme-version="1.26.8">
  
  <meta name="generator" content="Hexo 7.1.1">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>ARMA 学习笔记 - 千里之行，始于足下</title>

  
    <meta name="description" content="参考书：Time Series Analysis and Its Applications, 4-th Edition  基础概念时间序列：一组随机变量按照时间顺序下标得到的序列，被称为时间序列be defined as a collection of random variables indexed according to the order they areobtained in time">
<meta property="og:type" content="article">
<meta property="og:title" content="ARMA 学习笔记">
<meta property="og:url" content="http://bob-lytton.github.io/2024/05/08/ARMA-Learning/index.html">
<meta property="og:site_name" content="千里之行，始于足下">
<meta property="og:description" content="参考书：Time Series Analysis and Its Applications, 4-th Edition  基础概念时间序列：一组随机变量按照时间顺序下标得到的序列，被称为时间序列be defined as a collection of random variables indexed according to the order they areobtained in time">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-05-08T15:35:15.000Z">
<meta property="article:modified_time" content="2024-05-08T15:35:15.524Z">
<meta property="article:author" content="Bob Lytton">
<meta property="article:tag" content="Time Series">
<meta property="article:tag" content="Machine Learning">
<meta name="twitter:card" content="summary">
  
  
  
  <meta name="keywords" content="Time Series,Machine Learning">

  <!-- feed -->
  

  <link rel="stylesheet" href="/css/main.css?v=1.26.8">

  

  

  
  
</head>
<body>

<div class="l_body content tech" id="start" layout="post" ><aside class="l_left"><div class="sidebar-container">


<header class="header"><div class="logo-wrap"><a class="title" href="/"><div class="main" ff="title">千里之行，始于足下</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="站内搜索"></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div>


<nav class="menu dis-select"></nav>
</div>
<div class="widgets">

<widget class="widget-wrapper toc single" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">本文目录</span></div><div class="widget-body fs14"><div class="doc-tree active"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E5%BA%8F%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90"><span class="toc-text">时序场景下的回归分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EDA"><span class="toc-text">EDA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B3%E6%BB%91%E5%8C%96%EF%BC%88smoothing%EF%BC%89%E6%88%96%E6%BB%A4%E6%B3%A2"><span class="toc-text">平滑化（smoothing）或滤波</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AR%E6%A8%A1%E5%9E%8B"><span class="toc-text">AR模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AR-1-%E6%A8%A1%E5%9E%8B%E4%B8%8E%E5%9B%A0%E6%9E%9C%E6%80%A7%EF%BC%88causality%EF%BC%89"><span class="toc-text">AR(1)模型与因果性（causality）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MA%E6%A8%A1%E5%9E%8B"><span class="toc-text">MA模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MA-1-%E6%A8%A1%E5%9E%8B%E4%B8%8E%E5%8F%AF%E9%80%86%E6%80%A7%EF%BC%88invertibility%EF%BC%89"><span class="toc-text">MA(1)模型与可逆性（invertibility）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ARMA"><span class="toc-text">ARMA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ARIMA"><span class="toc-text">ARIMA</span></a></li></ol></div></div></widget>







<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">最近更新</span></div><div class="widget-body fs14"><a class="item title active" href="/2024/05/08/ARMA-Learning/"><span class="title">ARMA 学习笔记</span><svg class="active-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M21 11.098v4.993c0 3.096 0 4.645-.734 5.321c-.35.323-.792.526-1.263.58c-.987.113-2.14-.907-4.445-2.946c-1.02-.901-1.529-1.352-2.118-1.47a2.225 2.225 0 0 0-.88 0c-.59.118-1.099.569-2.118 1.47c-2.305 2.039-3.458 3.059-4.445 2.945a2.238 2.238 0 0 1-1.263-.579C3 20.736 3 19.188 3 16.091v-4.994C3 6.81 3 4.666 4.318 3.333C5.636 2 7.758 2 12 2c4.243 0 6.364 0 7.682 1.332C21 4.665 21 6.81 21 11.098" opacity=".5"/><path fill="currentColor" d="M9 5.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5z"/></svg></a><a class="item title" href="/2020/08/02/golang-fundamental/"><span class="title">Go语言入门</span></a><a class="item title" href="/2024/02/11/hello-world/"><span class="title">Hello World</span></a><a class="item title" href="/2020/08/02/intern-daily/"><span class="title">每日心得</span></a></div></widget>
</div>

</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    
<div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a>
<span class="sep"></span><a class="cap breadcrumb" href="/">文章</a></div>
<div class="flex-row" id="post-meta"><span class="text created">发布于：<time datetime="2024-05-08T15:35:15.000Z">2024-05-08</time></span><span class="sep updated"></span><span class="text updated">更新于：<time datetime="2024-05-08T15:35:15.524Z">2024-05-08</time></span></div></div>
</div>

    
    <div class="bottom">
      <div class="text-area">
        <h1 class="text title"><span>ARMA 学习笔记</span></h1>
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><blockquote>
<p>参考书：Time Series Analysis and Its Applications, 4-th Edition</p>
</blockquote>
<h1 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h1><p>时间序列：一组随机变量按照时间顺序下标得到的序列，被称为时间序列<br>be defined as a collection of random variables indexed according to the order they are<br>obtained in time.</p>
<p>白噪声：从不相关的随机变量中生成的时间序列被称为白噪声序列<br>The time series generated from uncorrelated variables is used as a model for noise in engineering applications,<br>where it is called white noise</p>
<p>移动平均过程：对白噪声序列应用移动平均计算获得的时间序列。可以起到filter的效果</p>
<blockquote>
<p>differ from the moving average series<br>because one particular kind of oscillatory behavior seems to predominate, producing<br>a sinusoidal type of behavior. A number of methods exist for generating series with<br>this quasi-periodic behavior; we illustrate a popular one based on the autoregressive<br>model<br>有周期性的时序数据不是移动平均过程</p>
</blockquote>
<p>A complete description of a time series, observed as a collection of n random variables<br>at arbitrary time points $t_1, t_2, . . . , t_n$ , for any positive integer $n$, is provided by the joint<br>distribution function, evaluated as the probability that the values of the series are<br>jointly less than the $n$ constants, $c_1, c_2, . . . , c_n$<br>$$<br>F_{t_1, t_2, …, t_n}(c_1, c_2, …, c_n) &#x3D; \Pr(x_{t_1} \le c_1, x_{t_2} \le c_2, …, x_{t_n} \le c_n)<br>$$<br>Although the joint distribution function describes the data completely, it is an<br><strong>unwieldy</strong> tool for displaying and analyzing time series data. The distribution func-<br>tion (1.8) must be evaluated as a function of n arguments, so any plotting of the<br>corresponding multivariate density functions is virtually impossible.<br>上述完整的概率分布函数只是一个模型，并不能直接使用。更有用的是下面的几个函数</p>
<p>marginal distribution functions:<br>$$<br>F_t(x) &#x3D; P{x_t \le x}<br>$$<br>marginal density functions:<br>$$<br>f_t(x) &#x3D; \frac{\partial F_t(x)}{\partial x}<br>$$</p>
<ul>
<li><p>期望函数（mean function）:<br>$$<br>\mu_{xt} &#x3D; \mathrm{E}(x_t) &#x3D; \int_{-\infty}^{\infty} xf_t(x)\mathrm{d}x<br>$$<br>$x$指随机变量，当只讨论一个时间序列时，通常把$\mu_{xt}$简写作$\mu_t$</p>
</li>
<li><p>自协方差函数（autocovariance function）:<br>$$<br>\gamma_x(s, t) &#x3D; \mathrm{cov}(x_s, x_t) &#x3D; \mathrm{E}[(x_s - \mu_s)(x_t - \mu_t)]<br>$$<br>其中$s$和$t$是下标，$x$是随机变量，只讨论一个时间序列时可简写为$\gamma(s, t)$。注意自协方差有性质$\gamma(s, t) &#x3D; \gamma(t, s)$<br>自协方差衡量同一时间序列中不同时间两点的线性相关性。平滑的序列，其自协方差会很大；不平滑的序列中，当$s$和$t$相隔很远时，自协方差会接近0。<br>当自协方差$\gamma(s, t) &#x3D; 0$时，$x_s$和$x_t$线性不相关，但仍然有可能有其他的相关性结构。<br>当$s &#x3D; t$时，自协方差退化为方差$\gamma(t, t) &#x3D; \mathrm{var}(x_t)$</p>
</li>
<li><p>性质：线性组合的协方差<br>对于两组随机变量${X_j}$和${Y_k}$，令$U &#x3D; \sum_{j&#x3D;1}^m a_jX_j$，$V&#x3D;\sum_{k&#x3D;1}^r b_kY_k$，则有<br>$$<br>\mathrm{cov}(U, V) &#x3D; \sum_{j&#x3D;1}^m\sum_{k&#x3D;1}^r a_jb_k\mathrm{cov}(X_j,Y_k)\<br>\mathrm{var}(U) &#x3D; \mathrm{cov}(U,U)<br>$$<br>该公式在后面会有广泛应用。</p>
</li>
</ul>
<p>例子：MA的自协方差<br>以MA模型<br>$$<br>v_t &#x3D; \frac{1}{3}(w_{t-1}+w_t+w_{t+1})<br>$$<br>为例，其自协方差为<br>$$<br>\begin{align*}<br>\gamma(s, t)<br>&amp;&#x3D;  \mathrm{cov}(v_s, v_t) \<br>&amp;&#x3D;  \left{ \begin{array}{ll}<br>            \frac{3}{9}\sigma_w^2 &amp; s &#x3D; t, \<br>            \frac{2}{9}\sigma_w^2 &amp; |s-t|&#x3D;1, \<br>            \frac{1}{9}\sigma_w^2 &amp; |s-t|&#x3D;2, \<br>            0 &amp; |s-t| &gt; 2<br>    \end{array}<br>    \right.<br>\end{align*}<br>$$<br>This particular autocovariance is interesting because it <strong>only depends on the time separation or lag</strong> and not on the absolute location of the points along the series.<br>We shall see later that this dependence suggests a mathematical model for the concept<br>of <strong>weak stationarity</strong>.</p>
<ul>
<li><p>自相关函数（autocorrelation function, ACF）<br>$$<br>\rho(s, t) &#x3D; \frac{\gamma(s, t)}{\sqrt{\gamma(s, s)\gamma(t, t)}}<br>$$<br>The ACF measures the linear predictability of the series at time $t$, say $x_t$ , using only<br>the value $x_s$.</p>
</li>
<li><p>强稳定性（strictly stationary）<br>$$<br>\Pr{x_{t_1}\le c_1, …, x_{t_k}\le c_k} &#x3D;<br>\Pr{x_{t_1+h}\le c_1, …, x_{t_k+h}\le c_k}<br>$$<br>对所有的$k$，$t_1, t_2, …, t_k$，$c_1, c_2, …, c_k$和$h$都成立。<br>严格稳定的时间序列的任何一段数据点的概率行为和将这一段在时间上平移$h$个单位后的数据点的概率行为相同</p>
</li>
</ul>
<p>推论1：强稳定的时间序列，当$k&#x3D;1$时，上式变成<br>$$<br>\Pr{x_s \le c}&#x3D;\Pr{x_t \le c}<br>$$<br>因而，其均值$\mu_t &#x3D; \mu_s$对任意$s, t$都成立，进而$\mu_t$<strong>是常数</strong></p>
<p>推论2：当$k&#x3D;2$时，上式可变为<br>$$<br>\Pr{x_s\le c_1, x_t\le c_2}&#x3D;\Pr{x_{s+h}\le c_1, x_{t+h}\le c_2}<br>$$<br>进而当该时序过程存在方差时，其自协方差满足<br>$$<br>\gamma(s, t) &#x3D; \gamma(s+h, t+h)<br>$$<br>即自协方差只取决于$s$到$t$的距离。</p>
<p>强稳定性的定义太强而在实际数据分析中不实用，只是作为一个理论模型而存在。</p>
<ul>
<li>弱稳定性（weak stationarity）</li>
</ul>
<p>满足强稳定性定义中的推论1（均值为常数）和推论2（自协方差只依赖于时间点之差）的性质的时间序列，被称为弱稳定的时间序列。通常称「稳定的」即是指弱稳定性。</p>
<p>在弱稳定时间序列中，均值为常数因此可写为$\mu_t &#x3D; \mu$，<br>自协方差可转写为只与时间差相关<br>$$<br>\gamma(t+h, t) &#x3D; \mathrm{cov}(x_{t+h}, x_t) &#x3D; \mathrm{cov}(x_h, x_0) &#x3D; \gamma(h, 0)<br>$$<br>ACF则可以改写为<br>$$<br>\rho(h) &#x3D; \frac{\gamma(t+h, t)}{\sqrt{\gamma(t+h, t+h)\gamma(t, t)}} &#x3D; \frac{\gamma(h)}{\gamma(0)}<br>$$</p>
<ul>
<li>趋势稳定性（trend stationarity）</li>
</ul>
<p>例如$x_t &#x3D; \alpha + \beta t + y_t$，其中$y_t$是弱稳定的时间序列，则$\mu_{xt} &#x3D; \alpha + \beta t + \mu_y$，不是与时间无关的常数，但其自协方差$\gamma_x(h) &#x3D; \mathrm{cov}(x_{t+h}, x_t) &#x3D; \mathrm{E}[(x_{t+h}-\mu_{x,t+h})(x_t - \mu_{x,t})] &#x3D; \mathrm{E}[(y_{t+h}-\mu_y)(y_t-\mu_y)] &#x3D; \gamma_y(h)$，因此该时序模型被认为是在线性趋势下有稳定性的，这种稳定性被称为趋势稳定性。</p>
<p>对于稳定序列，其自协方差是偶函数。即<br>$$<br>\gamma(h) &#x3D; \gamma((t+h)-t) &#x3D; \mathrm{cov}(x_{t+h}, x_t) &#x3D; \mathrm{cov}(x_t, x_{t+h}) &#x3D; \gamma(t - (t+h)) &#x3D; \gamma(-h)<br>$$<br>显然，这是因为$\mathrm{cov}$中的两个参数是可以交换的，而稳定序列中自协方差只和两点的时间距离有关</p>
<p>估计（estimation）一般指通过采样数据计算统计指标。</p>
<ul>
<li><p>样本自协方差（sample autocovariance function）<br>$$<br>\hat\gamma(h) &#x3D; \frac{1}{n}\sum_{t&#x3D;1}^{n-h}(x_{t+h}-\bar x)(x_t - \bar x)<br>$$<br>其中$\bar x$是样本均值，$h$是两个样本点的间隔</p>
</li>
<li><p>样本自相关函数（sample autocorrelation function）<br>$$<br>\hat\rho(h) &#x3D; \frac{\hat\gamma(h)}{\hat\gamma(0)}<br>$$<br>性质：样本量足够大时，如果时间序列$x_t$是白噪声序列，则样本ACF，即$\hat\rho_x(h), h&#x3D;1,2,…,H$，其中$H$是任意的但固定值，基本服从$N(0, \frac{1}{n})$的正态分布。<br>Based on the previous result, we obtain a rough method of assessing whether peaks<br>in $\hat\rho(h)$ are significant by determining whether the observed peak is outside the interval<br>$\pm2&#x2F;\sqrt n$ (or plus&#x2F;minus two standard errors), for a white noise sequence, approximately<br>$95%$ of the sample ACFs should be within these limits.</p>
</li>
</ul>
<h1 id="时序回归和EDA分析技巧"><a href="#时序回归和EDA分析技巧" class="headerlink" title="时序回归和EDA分析技巧"></a>时序回归和EDA分析技巧</h1><p>EDA：Exploratory Data Analysis，探索性数据分析。用于初步分析数据集的统计特性，以寻找进一步分析方向或进行可视化。</p>
<h2 id="时序场景下的回归分析"><a href="#时序场景下的回归分析" class="headerlink" title="时序场景下的回归分析"></a>时序场景下的回归分析</h2><p>$$<br>x_t &#x3D; \beta_0 + \beta_1 z_{t_1} + … + \beta_q z_{t_q} + w_t, w_t \sim wn(0, \sigma_w^2)<br>$$<br>上述式子的实际应用中，$w_t$实际上是误差项。上式同时包含了一个对误差项属于白噪声分布的前提假设。</p>
<ul>
<li>OLS (ordinary least square)</li>
<li>SSE (error sum of squares), SSR (regression sum of squares)</li>
<li>MSE (mean squared error)</li>
<li>$F$-statistics</li>
<li>$R^2$ (coefficient of determination)</li>
<li>AIC, AICc</li>
<li>BIC (a.k.a SIC)</li>
</ul>
<h2 id="EDA"><a href="#EDA" class="headerlink" title="EDA"></a>EDA</h2><p>真实数据集很可能不满足稳定性，而存在一些趋势。如何处理以构造稳定性？<br>$$<br>x_t &#x3D; \mu_t + y_t<br>$$<br>其中$x_t$是观测集（即真实数据集），$\mu_t$表示趋势，$y_t$是一个稳定过程。强趋势往往可能使得$y_t$被隐藏起来，因此EDA的第一步通常是移除观测集中的趋势项，得到残差序列（这个操作被称为detrending）<br>$$<br>\hat y_t &#x3D; x_t - \hat\mu_t<br>$$<br>在这里，$\mu_t$可以是前述线性回归得到的序列，也可以是其他有趋势性的随机过程建模的序列（比如漂移随机游走 random walk with drift）</p>
<p>使用随机游走过程对$\mu_t$建模，即<br>$$<br>\mu_t &#x3D; \delta + \mu_{t-1} + w_t<br>$$<br>则可对$x_t$做差分，得到<br>$$<br>\begin{align*}<br>x_t - x_{t-1} &amp;&#x3D; (\mu_t + y_t) - (\mu_{t-1} + y_{t-1}) \<br>&amp;&#x3D;\delta + w_t + y_t - y_{t-1}<br>\end{align*}<br>$$<br>令$z_t &#x3D; y_t - y_{t-1}$，则得到的序列$z_t$也是稳定序列，因为其均值为常数$0$，且其自协方差只与延迟（lag）相关<br>$$<br>\begin{align*}<br>\gamma_z(h) &amp;&#x3D; \mathrm{cov}(z_{t+h}, z_t) &#x3D; \mathrm{cov}(y_{t+h}-y_{t+h-1}, y_t-y_{t-1}) \<br>&amp;&#x3D; 2\gamma_y(h) - \gamma_y(h+1) - \gamma_y(h-1)<br>\end{align*}<br>$$<br>实际上，类似地也可以证明$x_t - x_{t-1}$也是稳定序列，这就是<strong>差分序列</strong>。</p>
<p>差分（differencing）相比去趋势（detrending）有一项优势，就是差分中没有需要估计的参数。同样也有一项劣势，即无法对前文设定的稳定序列$y_t$作出估计。当估计$y_t$很重要时，detrending可能是更合适的办法；而当目标只是为了调整数据获得稳定序列时，差分会更好用一些。</p>
<p>Differencing plays a central role in time series analysis. 差分在时间序列分析中有很重要的地位。一阶差分的符号表示为<br>$$<br>\nabla x_t &#x3D; x_t - x_{t-1}<br>$$<br>一阶差分可以消除线性趋势，类似的，二阶差分可以消除二次趋势（quadratic trend）<br>p.s. 二次的 quadratic，四次的 quartic</p>
<ul>
<li><p>后移算子（backshift operator）<br>$$<br>Bx_t &#x3D; x_{t-1}<br>$$<br>其中$B$为后移算子（也有用$L$来指代滞后算子lag operator的，效果相同）。<br>$$<br>B^k x_t &#x3D; x_{t-k}\<br>B^{-1}x_{t-1} &#x3D; x_t<br>$$<br>即$B^{-1}$为前移算子（forward-shift operator）</p>
</li>
<li><p>$d$阶差分算子<br>$$<br>\nabla^d &#x3D; (1-B)^d<br>$$<br>使用后移算子可以简便描述$d$阶差分算子。$d$阶差分即<br>$$<br>\begin{align*}<br>\nabla^d x_t &amp;&#x3D; (1-B)^d x_t \<br>&amp;&#x3D; x_t - \binom{d}{1}Bx_t + \binom{d}{2}B^2x_t -… + (-1)^dB^dx_t<br>\end{align*}<br>$$</p>
</li>
</ul>
<h2 id="平滑化（smoothing）或滤波"><a href="#平滑化（smoothing）或滤波" class="headerlink" title="平滑化（smoothing）或滤波"></a>平滑化（smoothing）或滤波</h2><p>例子</p>
<ul>
<li>moving average smoother</li>
<li>kernel smoothing</li>
<li>Lowess</li>
<li>Smoothing splines</li>
<li>smoothing one series as a function of another</li>
</ul>
<h1 id="ARIMA模型"><a href="#ARIMA模型" class="headerlink" title="ARIMA模型"></a>ARIMA模型</h1><p>Idea:</p>
<p>Classical regression is often insufficient for explaining<br>all of the interesting dynamics of a time series.<br>Instead, the introduction of correlation that may be<br>generated through lagged linear relations leads to<br>proposing the autoregressive<br>(AR) and autoregressive moving average (ARMA) models.<br>Adding nonstationary models to the mix leads to the<br>autoregressive integrated moving average (ARIMA) model.</p>
<p>关键点：parameter estimation, forecasting</p>
<h2 id="AR模型"><a href="#AR模型" class="headerlink" title="AR模型"></a>AR模型</h2><ul>
<li>经典回归模型 vs 自回归模型</li>
</ul>
<p>经典回归模型建立在「静态」场景上，只让因变量被独立变量的当前值所影响。<br>在时间序列场景下，人们需要让因变量受到独立变量的过去值乃至因变量自身的过去值的影响。而如果当前状态可以完全由独立变量的过去值建模的话，就可以进行<strong>预测</strong>了。</p>
<ul>
<li>定义：自回归模型（autoregressive model）<br>$$<br>x_t &#x3D; \phi_1 x_{t-1} + \phi_2 x_{t-2} + … + \phi_p x_{t-p} + w_t<br>$$<br>是$p$阶自回归模型，简写做$\mathrm{AR}(p)$。其中$w_t \sim wn(0, \sigma_w^2)$是白噪声项，$\phi_1, \phi_2, …, \phi_p$是常数，且$\phi_p \ne 0$。<br>在AR模型中，$x_t$是稳定的，且可以认为均值为0。如果其均值$\mu$不为0，则将$x_t$用$x_t - \mu$来替代，得到<br>$$<br>x_t - \mu &#x3D; \phi_1(x_{t-1}-\mu) + … + \phi_p(x_{t-p} - \mu) + w_t<br>$$<br>上式等价于<br>$$<br>x_t &#x3D; \alpha + \phi_1 x_{t-1} + \phi_2 x_{t-2} + … + \phi_p x_{t-p} + w_t,\<br>where\ \alpha &#x3D; \mu(1-\phi_1 - … - \phi_p)<br>$$<br>这就是常见的另外一种AR模型的定义式。</li>
</ul>
<p>对自回归模型的定义式应用后移算子并稍作变形，得到下式<br>$$<br>(1-\phi_1 B - \phi_2 B^2 - … - \phi_p B^p)x_t &#x3D; w_t<br>$$<br>实际应用模型时，需要首先解出$\phi_1, \phi_2, …, \phi_p$，上式对此有重要意义。为此有如下定义：</p>
<ul>
<li>定义：自回归算子（autoregressive operator）<br>$$<br>\phi(B) &#x3D; 1-\phi_1 B - \phi_2 B^2 - … - \phi_p B^p<br>$$<br>为自回归算子。则AR模型可重新写成$\phi(B)x_t &#x3D; w_t$.</li>
</ul>
<h3 id="AR-1-模型与因果性（causality）"><a href="#AR-1-模型与因果性（causality）" class="headerlink" title="AR(1)模型与因果性（causality）"></a>AR(1)模型与因果性（causality）</h3><p>考虑AR(1)模型如下<br>$$<br>x_t &#x3D; \phi x_{t-1} + w_t<br>$$<br>迭代计算可得<br>$$<br>\begin{align*}<br>x_t &amp;&#x3D; \phi x_{t-1} + w_t \<br>    &amp;&#x3D; \phi (\phi x_{t-2} + w_{t-1}) + w_t \<br>    &amp;&#x3D; \phi^2 x_{t-2} + \phi w_{t-1} + w_t \<br>    &amp;&#x3D;… \<br>    &amp;&#x3D; \phi^k x_{t-k} + \sum_{i&#x3D;0}^{k-1}\phi^i w_{t-i}<br>\end{align*}<br>$$</p>
<ul>
<li>当$|\phi| &lt; 1$时，由于<br>$$<br>\lim_{k\to\infty}\mathrm{E}\left(x_t-\sum_{j&#x3D;0}^{k-1}\phi^jw_{t-j}\right)^2 &#x3D; \lim_{k\to\infty}\phi^{2k}\mathrm{E}(x_{t-k}^2) &#x3D; 0<br>$$<br>故可以无限迭代上式，得到<br>$$<br>x_t &#x3D; \sum_{i&#x3D;0}^\infty \phi^i w_{t-i}<br>$$<br>均方收敛。其均值为<br>$$<br>\mu &#x3D; \mathrm{E}(x_t) &#x3D; \sum_{i&#x3D;0}^\infty \phi^i\mathrm{E}(w_{t-i}) &#x3D; 0<br>$$<br>自协方差为<br>$$<br>\begin{align*}<br>\gamma(h) &amp;&#x3D; \mathrm{cov}(x_{t+h}, x_t) &#x3D; \mathrm{cov}\left[\left(\sum_{i&#x3D;0}^\infty \phi^iw_{t+h-i}\right), \left(\sum_{j&#x3D;0}^\infty\phi^j w_{t-j}\right)\right] \<br>&amp;&#x3D; \underbrace{\sum_{i&#x3D;0}^{h-1}\sum_{j&#x3D;0}^\infty \phi^i \phi^j\mathrm{cov}(w_{t+h-i}, w_{t-j})}<em>{&#x3D;0} +<br>\underbrace{\sum</em>{i&#x3D;h}^\infty\sum_{j&#x3D;0}^{\infty,j\ne i-h}\phi^i\phi^j\mathrm{cov}(w_{t+h-i}, w_{t-j})}<em>{&#x3D;0} +<br>\sum</em>{k&#x3D;0}^\infty\phi^{k+h}\phi^k\mathrm{cov}(w_k, w_k)\<br>&amp;&#x3D;\sigma_w^2 \sum_{i&#x3D;0}^\infty \phi^{h+i}\phi^i \<br>&amp;&#x3D;\sigma_w^2\phi^h\sum_{i&#x3D;0}^\infty\phi^{2i} &#x3D; \frac{\sigma_w^2\phi^h}{1-\phi^2}, \ h\ge 0.<br>\end{align*}<br>$$<br>进而可以得到ACF的表达式如下<br>$$<br>\rho(h) &#x3D; \frac{\gamma(h)}{\gamma(0)} &#x3D; \phi^h, \ h\ge 0<br>$$<br>即$\rho(h)$是关于$h$的等比数列，$\rho(h) &#x3D; \phi\rho(h-1), h&#x3D;1,2,…$</li>
</ul>
<p>一个有趣的现象是，当$-1 &lt; \phi &lt; 0$时，得到的时间序列${x_t}$中，相邻两项呈负相关，而隔了一项后的两项（$x_t, x_{t-2}$）呈正相关。因而此时的时序图线会很曲折。</p>
<ul>
<li>现在考虑$|\phi| \ge 1$的情况（explosive case）</li>
</ul>
<p>当$\phi &#x3D; 1$时，$x_t &#x3D; x_{t-1}+w_t$，退化成随机游走模型，<br>其自协方差为$\gamma_x(s, t) &#x3D; \mathrm{cov}(x_s, x_t) &#x3D; \min{s,t}\sigma_w^2$。因而该随机游走模型不稳定。</p>
<p>当$|\phi| &gt; 1$时，有$|\phi|^j \to \infty$，因此$\sum_{j&#x3D;0}^{k-1} \phi^j w_{t-j}$在$k\to\infty$时均方不收敛，因而不能直接用前面的方式来进行后续推导。做变形如下，令$x_{t+1}&#x3D;\phi x_t+w_{t+1}$，则有<br>$$<br>\begin{align*}<br>x_t &amp;&#x3D; \phi^{-1}x_{t+1} - \phi^{-1}w_{t+1} &#x3D; \phi^{-1}(\phi^{-1}x_{t+2}-\phi^{-1}w_{t+2})-\phi^{-1}w_{t+1}\<br>&amp;&#x3D; … \<br>&amp;&#x3D; \phi^{-k}x_{t+k} - \sum_{j&#x3D;1}^{k-1}\phi^{-j}w_{t+j}<br>\end{align*}<br>$$<br>即向前迭代$k$步，由于$|\phi|^{-1} &lt; 1$，故该前向递推式仍然适用之前的推导，可得<br>$$<br>x_t &#x3D; -\sum_{j&#x3D;1}^\infty \phi^{-j}w_{t+j}<br>$$<br>同样可以证明该过程是稳定的。<br>当然，这个式子<strong>没有什么用</strong>，因为当前状态依赖于未来状态，故此情景下无法用该模型去预测未来的数据。当前状态不依赖于未来状态的时间序列被称为<strong>因果过程</strong>（causal process）。<br>根据上式计算自协方差得到：<br>$$<br>\begin{align*}<br>\gamma_x(h) &amp;&#x3D; \mathrm{cov}(x_{t+h}, x_t)<br>&#x3D; \mathrm{cov}\left(-\sum_{j&#x3D;1}^\infty\phi^{-j}w_{t+h+j}, -\sum_{k&#x3D;1}^\infty\phi^{-k}w_{t+k} \right)\<br>&amp;&#x3D;\frac{\sigma_w^2\phi^{-2}\phi^{-h}}{1-\phi^{-2}}<br>\end{align*}<br>$$<br>下面是有趣的地方了。定义下述因果过程<br>$$<br>y_t &#x3D; \phi^{-1}y_{t-1} + v_t<br>$$<br>其中$v_t\sim \mathrm{iid}\ \mathrm{N}(0, \sigma_w^2\phi^{-2})$为白噪声，则${y_t}$与${x_t}$随机等价（stochastically equal）。</p>
<p>如果用自回归算子来表示AR(1)过程，则有<br>$$<br>\phi(B) x_t &#x3D; w_t,\ where\ \phi(B) &#x3D; 1-\phi B<br>$$<br>又从上文得到<br>$$<br>x_t &#x3D; \sum_{j&#x3D;0}^\infty \psi_j w_{t-j} &#x3D; \psi(B)w_t<br>$$<br>代入前式，于是有<br>$$<br>\phi(B)\psi(B) w_t &#x3D; w_t<br>$$<br>即<br>$$<br>\begin{align*}<br>&amp; (1-\phi B)(1+\psi_1 B + \psi_2 B^2 + … + \psi_j B^j + …) &#x3D; 1 \<br>\implies &amp;(1-\phi B)(1 + (\psi_1 - \phi)B + (\psi_2-\psi_1 \phi)B^2 + … + (\psi_j-\psi_{j-1}\phi)B^j + …) &#x3D; 1<br>\end{align*}<br>$$<br>于是有$\psi_j &#x3D; \psi_{j-1}\phi$，且$\psi_0&#x3D;1$，因此$\psi_j &#x3D; \phi^j$.<br>从多项式的角度看，可以定义$\phi(B)$的逆算子$\phi^{-1}(B)$，则有上面的推导可知<br>$$<br>\phi^{-1}(B) &#x3D; 1 + \phi B + \phi^2 B^2 + … + \phi^j B^j + … &#x3D; \frac{1}{1-\phi B}<br>$$<br>逆算子刚好符合多项式的性质。</p>
<p>p.s. 浅补一下泛函分析相关概念：</p>
<ul>
<li>空间：集合+距离</li>
<li>泛函：空间到数域的映射</li>
<li>算子：空间到空间的映射<ul>
<li>线性算子：满足线性性的算子，即$f(\alpha x + \beta y) &#x3D; \alpha f(x) + \beta f(y)$</li>
<li>线性算子的多项式还是个线性算子</li>
</ul>
</li>
</ul>
<p>p.p.s. 随机过程相关概念</p>
<ul>
<li>均方收敛：</li>
<li>随机等价：两个随机过程的有限分布都相同</li>
</ul>
<h2 id="MA模型"><a href="#MA模型" class="headerlink" title="MA模型"></a>MA模型</h2><p>MA模型假设观测数据由白噪声组成。下面是$q$阶移动平均（moving average）模型的定义，也可记为$\mathrm{MA}(q)$：<br>$$<br>x_t &#x3D; w_t + \theta_1 w_{t-1} + \theta_2 w_{t-2} + … + \theta_q w_{t-q}<br>$$<br>其中$w_t\sim wn(0, \sigma_w^2)$是白噪声项（误差项），$\theta_1, \theta_2, …, \theta_q(\theta_q \ne 0)$是参数。</p>
<p>可以发现AR(1)模型就是一个有无限项的MA模型。</p>
<p>定义移动平均算子（moving average operator）为<br>$$<br>\theta(B) &#x3D; 1 + \theta_1B + \theta_2 B^2 + … + \theta_q B^q<br>$$<br>则MA模型可重新写成$x_t &#x3D; \theta(B)w_t$.</p>
<h3 id="MA-1-模型与可逆性（invertibility）"><a href="#MA-1-模型与可逆性（invertibility）" class="headerlink" title="MA(1)模型与可逆性（invertibility）"></a>MA(1)模型与可逆性（invertibility）</h3><h2 id="ARMA"><a href="#ARMA" class="headerlink" title="ARMA"></a>ARMA</h2><h2 id="ARIMA"><a href="#ARIMA" class="headerlink" title="ARIMA"></a>ARIMA</h2>
<div class="article-footer fs14">
    <section id="license">
      <div class="header"><span>许可协议</span></div>
      <div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div>
    </section>
    </div>
</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"></div><div class="item" id="next"><div class="note">较早文章</div><a href="/2024/02/11/hello-world/">Hello World</a></div></section></div>






<footer class="page-footer footnote"><hr><div class="text"><p>本站由 <a href="/">Bob Lytton</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.26.8">Stellar 1.26.8</a> 主题创建。<br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
</div></footer>
<div class='float-panel mobile-only blur' style='display:none'>
  <button type='button' class='sidebar-toggle mobile' onclick='sidebar.toggle()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
<div class="main-mask" onclick="sidebar.toggle()"></div></div></div><div class="scripts">
<script type="text/javascript">
  const stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = stellar.config.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.version = '1.26.8';
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.26.8';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
    root : '/',
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js'
  };

  if ('local_search') {
    stellar.search = {};
    stellar.search.service = 'local_search';
    if (stellar.search.service == 'local_search') {
      let service_obj = Object.assign({}, {"field":"all","path":"/search.json","content":true,"sort":"-date"});
      stellar.search[stellar.search.service] = service_obj;
    }
  }

  // stellar js
  stellar.plugins.stellar = Object.assign({"sites":"/js/plugins/sites.js","friends":"/js/plugins/friends.js","ghinfo":"/js/plugins/ghinfo.js","timeline":"/js/plugins/timeline.js","linkcard":"/js/plugins/linkcard.js","fcircle":"/js/plugins/fcircle.js","weibo":"/js/plugins/weibo.js","memos":"/js/plugins/memos.js","marked":"/js/plugins/marked.js"});

  stellar.plugins.marked = Object.assign("https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js");
  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://cdn.bootcdn.net/ajax/libs/vanilla-lazyload/17.8.4/lazyload.min.js","transition":"fade"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper@10.3/swiper-bundle.min.css","js":"https://unpkg.com/swiper@10.3/swiper-bundle.min.js"});
  }
  if ('' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":null,"js":"https://cdn.bootcdn.net/ajax/libs/scrollReveal.js/4.0.9/scrollreveal.min.js","distance":"16px","duration":800,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","flying_pages":"https://cdn.bootcdn.net/ajax/libs/flying-pages/2.1.2/flying-pages.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.fancybox = Object.assign({"enable":true,"js":"https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.umd.min.js","css":"https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.min.css","selector":null});
  }
  if ('false' == 'true') {
    stellar.plugins.heti = Object.assign({"enable":false,"css":"https://unpkg.com/heti@0.9.2/umd/heti.min.css","js":"https://unpkg.com/heti@0.9.2/umd/heti-addon.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.copycode = Object.assign({"enable":true,"js":"/js/plugins/copycode.js","default_text":"Copy","success_text":"Copied","toast":"复制成功"});
  }
</script>

<!-- required -->
<script src="/js/main.js?v=1.26.8" async></script>

<!-- optional -->






<!-- inject -->

</div></body></html>
